!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(c){c.fn.ddslick=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void c.error("Method "+e+" does not exists."):d.init.apply(this,arguments)};var d={},r={},p={data:[],keepJSONItemsOnTop:!1,animationTime:50,width:"20em",height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,onSelected:function(){}},f=!1;function t(e,d){d=e.find(".dd-option-value[value= '"+d+"']").parents("li").prevAll().length;u(e,d)}function u(e,d,t){var i=e.data("ddslick"),n=e.find(".dd-selected"),a=e.find(".dd-options"),o=n.siblings(".dd-selected-value"),s=e.find(".dd-option").eq(d),l=i.settings,r=i.settings.data[d];e.find(".dd-option").removeClass("dd-option-selected"),s.addClass("dd-option-selected"),a.attr("aria-activedescendant",s.attr("id")),i.selectedIndex=d,i.selectedItem=s,i.selectedData=r,l.showSelectedHTML?(s=c("<div>"),r.imageSrc&&s.append(c("<img>").addClass("dd-selected-image"+("right"===l.imagePosition?" dd-image-right":"")).attr("src",r.imageSrc)),r.text&&s.append(c("<label>").addClass("dd-selected-text").text(r.text)),r.description&&s.append(c("<small>").addClass("dd-selected-description dd-desc"+(l.truncateDescription?" dd-selected-description-truncated":"")).text(r.description)),n.html(s.html())):n.html(r.text),o.val(r.value),i.original.val(r.value),e.data("ddslick",i),g(e),e.find(".dd-selected").focus(),o=(n=e).find(".dd-select").css("height"),r=n.find(".dd-selected-description"),e=n.find(".dd-selected-image"),r.length<=0&&0<e.length&&n.find(".dd-selected-text").css("lineHeight",o),t&&"function"==typeof l.onSelected&&l.onSelected.call(this,i)}function h(e){var n,d=e.find(".dd-select"),t=e.find(".dd-selected"),i=d.siblings(".dd-options"),a=d.find(".dd-pointer"),o=i.is(":visible"),s=r[e.attr("data-settings-id")];c(".dd-click-off-close").not(i).slideUp(s.animationTime),c(".dd-pointer").removeClass("dd-pointer-up"),d.removeClass("dd-open"),t.attr("aria-expanded","false"),i.attr("aria-hidden","true"),o?(i.slideUp(s.animationTime),a.removeClass("dd-pointer-up"),d.removeClass("dd-open"),t.attr("aria-expanded","false"),i.attr("aria-hidden","true")):(d.addClass("dd-open"),i.slideDown(s.animationTime),a.addClass("dd-pointer-up"),t.attr("aria-expanded","true"),i.attr("aria-hidden","false").focus()),(n=e).find(".dd-option").each(function(){var e=c(this),d=e.css("height"),t=e.find(".dd-option-description"),i=n.find(".dd-option-image");t.length<=0&&0<i.length&&e.find(".dd-option-text").css("lineHeight",d)})}function g(e){var d=r[e.attr("data-settings-id")];e.find(".dd-select").removeClass("dd-open"),e.find(".dd-selected").attr("aria-expanded","false"),e.find(".dd-options").slideUp(d.animationTime).attr("aria-hidden","true"),e.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}d.init=function(l){var e=c.extend({},p,l);return c("#css-ddslick").length<=0&&e.embedCSS&&c("<style id='css-ddslick' type='text/css'>.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ position:relative; overflow:hidden; display:block; padding:10px; font-weight:bold; width:100%; text-align:left;}.dd-selected:focus { z-index:2001; }.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-selected:focus + .dd-pointer{ z-index:2002; }.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:visible;}.dd-options:focus{ outline:0; }.dd-option{ padding:10px; display:block; width:100%; text-align:left; border-bottom:solid 1px #ddd; overflow:visible; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; box-sizing:border-box;}.dd-options > .dd-option:last-child { border-bottom:none;}.dd-option:hover, .dd-option:active, .dd-option:focus{ background:#f3f3f3; color:#000; z-index:2001;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;} .dd-selected-text { font-weight:bold}</style>").appendTo("head"),this.each(function(){var e,t,i,n,a,d,o=c.extend({},p,l),s=c(this);s.data("ddslick")||(n=[],s.find("option").each(function(){var e=c(this),d=e.data();n.push({text:c.trim(e.text()),value:e.val(),selected:e.is(":selected"),description:d.description,imageSrc:d.imagesrc})}),o.keepJSONItemsOnTop?c.merge(o.data,n):o.data=c.merge(n,o.data),d=s,e=c("<div>").attr("id",s.attr("id")),s.replaceWith(e),s=e,t="ID_"+(new Date).getTime(),c(s).attr("data-settings-id",t),r[t]={},c.extend(r[t],o),s.addClass("dd-container").append("<div class='dd-select'><input class='dd-selected-value' type='hidden' /><button type='button' class='dd-selected'></button><span class='dd-pointer dd-pointer-down'></span></div>").append("<ul class='dd-options'></ul>"),s.find("input.dd-selected-value").attr("id",c(d).attr("id")).attr("name",c(d).attr("name")),i=s.find(".dd-options"),n=s.find(".dd-select"),(a=s.find(".dd-selected")).attr("aria-haspopup","listbox"),a.attr("aria-expanded","false"),a.attr("aria-controls","dd-options-"+t),i.attr("id","dd-options-"+t),i.attr("role","listbox"),i.attr("tabindex","-1"),i.attr("aria-label","select options"),i.attr("aria-hidden","true"),i.css({width:o.width}),n.css({width:o.width,background:o.background}),s.css({width:o.width}),null!==o.height&&i.css({height:o.height,overflow:"auto"}),c.each(o.data,function(e,d){d.selected&&(o.defaultSelectedIndex=e);e=c("<li role='option'>").addClass("dd-option").attr("id","dd-option-"+t+"-"+e);d.value&&e.append(c("<input>").addClass("dd-option-value").attr("type","hidden").val(d.value)),d.imageSrc&&e.append(c("<img>").attr("src",d.imageSrc).addClass("dd-option-image"+("right"===o.imagePosition?" dd-image-right":""))),d.text&&e.append(c("<label>").addClass("dd-option-text").text(d.text)),d.description&&e.append(c("<small>").addClass("dd-option-description dd-desc").text(d.description)),i.append(e)}),i.keydown(function(e){var d=c(this);if("false"==d.attr("aria-hidden")){var t="dd-option-selected",i=[],n=c("."+t,d);switch(e.key){case"ArrowLeft":case"ArrowUp":return n.length?n.is(":first-child")||(i=n.removeClass(t).prev().addClass(t),d.attr("aria-activedescendant",i.attr("id"))):((i=c(".dd-option:first-child")).addClass(t),d.attr("aria-activedescendant",i.attr("id"))),!1;case"ArrowRight":case"ArrowDown":return n.length?n.is(":last-child")||(i=n.removeClass(t).next().addClass(t),d.attr("aria-activedescendant",i.attr("id"))):((i=c(".dd-option:first-child")).addClass(t),d.attr("aria-activedescendant",i.attr("id"))),!1;case"Enter":case" ":return n.length&&u(s,n.index(),!0),g(s),a.focus(),!1;case"Escape":return g(s),a.focus(),!1}}}),s.data("ddslick",{settings:o,original:d,selectedIndex:-1,selectedItem:null,selectedData:null}),0<o.selectText.length&&null===o.defaultSelectedIndex?s.find(".dd-selected").html(o.selectText):(d=null!=o.defaultSelectedIndex&&0<=o.defaultSelectedIndex&&o.defaultSelectedIndex<o.data.length?o.defaultSelectedIndex:0,u(s,d,!1)),s.find(".dd-select").on("click.ddslick",function(){h(s)}),s.find(".dd-option").on("click.ddslick",function(){u(s,c(this).index(),!0)}),s.find(".dd-options").on("focusout.ddslick",function(){setTimeout(function(){0==s.find(".dd-options").has(document.activeElement).length&&g(s)},50)}),o.clickOffToClose&&(i.addClass("dd-click-off-close"),s.on("click.ddslick",function(e){e.stopPropagation()}),f||(f=!0,c("body").on("click",function(){c(".dd-open").removeClass("dd-open"),c(".dd-selected").attr("aria-expanded","false"),c(".dd-click-off-close").slideUp(o.animationTime).attr("aria-hidden","true").siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")}))))})},d.select=function(e){return this.each(function(){void 0!==e.index&&u(c(this),e.index),void 0!==e.value&&t(c(this),e.value),void 0!==e.id&&t(c(this),e.id)})},d.open=function(){return this.each(function(){var e=c(this);e.data("ddslick")&&h(e)})},d.close=function(){return this.each(function(){var e=c(this);e.data("ddslick")&&g(e)})},d.destroy=function(){return this.each(function(){var e=c(this),d=e.data("ddslick");d&&(d=d.original,e.removeData("ddslick").unbind(".ddslick").replaceWith(d))})}});